<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Numerical Differentiation | Numerical Analysis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Numerical Differentiation | Numerical Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Numerical Differentiation | Numerical Analysis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Sai Saandeep.S, Dr. Sivaram" />


<meta name="date" content="2024-12-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="root-finding-algorithms.html"/>
<link rel="next" href="solving-ordinary-differential-equations-numerically.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-numerical-analysis"><i class="fa fa-check"></i><b>1.1</b> Why Numerical Analysis?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#representing-numbers-on-a-machine"><i class="fa fa-check"></i><b>1.2</b> Representing Numbers on a Machine</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#condition-number-of-a-problem"><i class="fa fa-check"></i><b>1.3</b> Condition Number of a Problem</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#vector-normsrecap"><i class="fa fa-check"></i><b>1.3.1</b> Vector Norms(Recap)</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#examples-on-finding-condition-number"><i class="fa fa-check"></i><b>1.3.2</b> Examples on finding Condition number</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html"><i class="fa fa-check"></i><b>2</b> Numerical Linear Algebra</a>
<ul>
<li class="chapter" data-level="2.1" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#columnspace-nullspace-and-all"><i class="fa fa-check"></i><b>2.1</b> Columnspace, Nullspace and all</a></li>
<li class="chapter" data-level="2.2" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#matrix-norms"><i class="fa fa-check"></i><b>2.2</b> Matrix Norms</a></li>
<li class="chapter" data-level="2.3" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#condition-number-of-matrix-vector-products"><i class="fa fa-check"></i><b>2.3</b> Condition number of Matrix vector products</a></li>
<li class="chapter" data-level="2.4" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#solving-linear-systems"><i class="fa fa-check"></i><b>2.4</b> Solving Linear Systems</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#special-matrices"><i class="fa fa-check"></i><b>2.4.1</b> Special Matrices</a></li>
<li class="chapter" data-level="2.4.2" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#general-case"><i class="fa fa-check"></i><b>2.4.2</b> General Case</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#solving-overdetermined-systems"><i class="fa fa-check"></i><b>2.5</b> Solving Overdetermined Systems</a></li>
<li class="chapter" data-level="2.6" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#solving-underdetermined-systems"><i class="fa fa-check"></i><b>2.6</b> Solving Underdetermined Systems</a></li>
<li class="chapter" data-level="2.7" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#iterative-methods-for-solving-linear-systems"><i class="fa fa-check"></i><b>2.7</b> Iterative Methods for solving Linear Systems</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="interpolation.html"><a href="interpolation.html"><i class="fa fa-check"></i><b>3</b> Interpolation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="interpolation.html"><a href="interpolation.html#motivation---interpolation-vs.-approximation"><i class="fa fa-check"></i><b>3.1</b> Motivation - Interpolation vs. Approximation</a></li>
<li class="chapter" data-level="3.2" data-path="interpolation.html"><a href="interpolation.html#lagrange-interpolation"><i class="fa fa-check"></i><b>3.2</b> Lagrange Interpolation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="interpolation.html"><a href="interpolation.html#motivation"><i class="fa fa-check"></i><b>3.2.1</b> Motivation</a></li>
<li class="chapter" data-level="3.2.2" data-path="interpolation.html"><a href="interpolation.html#lagrange-interpolant"><i class="fa fa-check"></i><b>3.2.2</b> Lagrange Interpolant</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="interpolation.html"><a href="interpolation.html#choice-of-nodes"><i class="fa fa-check"></i><b>3.3</b> Choice of Nodes</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="interpolation.html"><a href="interpolation.html#motivation-1"><i class="fa fa-check"></i><b>3.3.1</b> Motivation</a></li>
<li class="chapter" data-level="3.3.2" data-path="interpolation.html"><a href="interpolation.html#fundamental-theorem-of-polynomial-interpolation"><i class="fa fa-check"></i><b>3.3.2</b> Fundamental Theorem of Polynomial Interpolation</a></li>
<li class="chapter" data-level="3.3.3" data-path="interpolation.html"><a href="interpolation.html#different-possible-types-of-nodes"><i class="fa fa-check"></i><b>3.3.3</b> Different Possible types of nodes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="interpolation.html"><a href="interpolation.html#wierstrass-approximation-theorem"><i class="fa fa-check"></i><b>3.4</b> Wierstrass Approximation theorem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadratures.html"><a href="quadratures.html"><i class="fa fa-check"></i><b>4</b> Quadratures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadratures.html"><a href="quadratures.html#motivation-2"><i class="fa fa-check"></i><b>4.1</b> Motivation</a></li>
<li class="chapter" data-level="4.2" data-path="quadratures.html"><a href="quadratures.html#different-schemes"><i class="fa fa-check"></i><b>4.2</b> Different Schemes</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="quadratures.html"><a href="quadratures.html#basic-schemes"><i class="fa fa-check"></i><b>4.2.1</b> Basic Schemes</a></li>
<li class="chapter" data-level="4.2.2" data-path="quadratures.html"><a href="quadratures.html#accuracy-of-these-schemes"><i class="fa fa-check"></i><b>4.2.2</b> Accuracy of these schemes</a></li>
<li class="chapter" data-level="4.2.3" data-path="quadratures.html"><a href="quadratures.html#simpsons-rule"><i class="fa fa-check"></i><b>4.2.3</b> Simpson’s Rule</a></li>
<li class="chapter" data-level="4.2.4" data-path="quadratures.html"><a href="quadratures.html#trapezoidal-rule-with-end-point-corrections"><i class="fa fa-check"></i><b>4.2.4</b> Trapezoidal Rule with End point Corrections</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="quadratures.html"><a href="quadratures.html#euler-maclaurian-formula"><i class="fa fa-check"></i><b>4.3</b> Euler-Maclaurian Formula</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="quadratures.html"><a href="quadratures.html#introduction-1"><i class="fa fa-check"></i><b>4.3.1</b> Introduction</a></li>
<li class="chapter" data-level="4.3.2" data-path="quadratures.html"><a href="quadratures.html#formula-and-derivation"><i class="fa fa-check"></i><b>4.3.2</b> Formula and Derivation</a></li>
<li class="chapter" data-level="4.3.3" data-path="quadratures.html"><a href="quadratures.html#examples"><i class="fa fa-check"></i><b>4.3.3</b> Examples</a></li>
<li class="chapter" data-level="4.3.4" data-path="quadratures.html"><a href="quadratures.html#higher-order-quadratures"><i class="fa fa-check"></i><b>4.3.4</b> Higher Order Quadratures</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="quadratures.html"><a href="quadratures.html#gaussian-quadratures"><i class="fa fa-check"></i><b>4.4</b> Gaussian Quadratures</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html"><i class="fa fa-check"></i><b>5</b> Root Finding Algorithms</a>
<ul>
<li class="chapter" data-level="5.1" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#motivation-3"><i class="fa fa-check"></i><b>5.1</b> Motivation</a></li>
<li class="chapter" data-level="5.2" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#bisection-method"><i class="fa fa-check"></i><b>5.2</b> Bisection Method</a></li>
<li class="chapter" data-level="5.3" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#newton-method"><i class="fa fa-check"></i><b>5.3</b> Newton Method</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#rate-of-convergence"><i class="fa fa-check"></i><b>5.3.1</b> Rate of Convergence</a></li>
<li class="chapter" data-level="5.3.2" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#possibility-of-non-convergence"><i class="fa fa-check"></i><b>5.3.2</b> Possibility of Non-Convergence?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html"><i class="fa fa-check"></i><b>6</b> Numerical Differentiation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html#motivation-4"><i class="fa fa-check"></i><b>6.1</b> Motivation</a></li>
<li class="chapter" data-level="6.2" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html#finite-differences"><i class="fa fa-check"></i><b>6.2</b> Finite Differences</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html"><i class="fa fa-check"></i><b>7</b> Solving Ordinary Differential Equations Numerically</a>
<ul>
<li class="chapter" data-level="7.1" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#different-basic-methods"><i class="fa fa-check"></i><b>7.2</b> Different Basic Methods</a></li>
<li class="chapter" data-level="7.3" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#linear-stability-analysis"><i class="fa fa-check"></i><b>7.3</b> Linear Stability Analysis</a></li>
<li class="chapter" data-level="7.4" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#accuracy"><i class="fa fa-check"></i><b>7.4</b> Accuracy</a></li>
<li class="chapter" data-level="7.5" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#simple-pendulum---solving-system-of-odes"><i class="fa fa-check"></i><b>7.5</b> Simple Pendulum - Solving System of ODEs</a></li>
<li class="chapter" data-level="7.6" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#simple-pendulum---finite-difference-for-2nd-order-derivative"><i class="fa fa-check"></i><b>7.6</b> Simple Pendulum - Finite difference for 2nd order derivative</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Numerical Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="numerical-differentiation" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Numerical Differentiation<a href="numerical-differentiation.html#numerical-differentiation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="motivation-4" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Motivation<a href="numerical-differentiation.html#motivation-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given a continuous function <span class="math inline">\(f(x)\)</span>. We have seen that finding anti-derivative for all functions is not possible and hence, we resort to finding approximate values of definite integrals using Numerical methods(Quadratures). But derivatives can be found for any differentiable function <span class="math inline">\(f(x)\)</span> using Chain rule etc.,</p>
<p>Eg:- Consider <span class="math inline">\(f(x) = \cos(x^2)\)</span> which is continuous and differentiable.</p>
<p><span class="math inline">\(\int_0^1 f(x) \, dx = \int_0^1 \cos(x^2)\, dx\)</span> has no closed form. But <span class="math inline">\(f&#39;(x) = -2x\sin(x^2)\)</span> which can be found using chain rule.</p>
<p>Now the question which naturally arises is: Why do we need to think of finding derivatives numerically then?</p>
<ol style="list-style-type: decimal">
<li><p>Consider the case where <span class="math inline">\(f(x)\)</span> is known at discrete node points <span class="math inline">\(\{x_i\}_{i=0}^n\)</span>. To find derivatives at these nodes, one way is to interpolate using an interpolant polynomial <span class="math inline">\(p(x)\)</span> and then find <span class="math inline">\(p&#39;(x)\)</span>. We can find using a less computationally expensive way as will be discussed in this chapter.</p></li>
<li><p>Solving Differential Equations</p>
<ol style="list-style-type: lower-alpha">
<li><strong>Ordinary Differential Equations(ODEs):</strong></li>
</ol>
<p><strong>Simple Pendulum:-</strong></p>
<p><strong>ATTACH SIMPLE PENDULUM PIC WITH ITS FBD</strong></p>
<p>For simple pendulum with no damping and using small angle approximation about equilibrium position, we have the equation of motion as:
<span class="math display">\[\begin{equation}
\frac{d^2\theta}{dt^2}+\frac{g}{l}\theta = 0
\end{equation}\]</span>
with initial conditions <span class="math inline">\(\theta(t=0)= \theta_0\)</span> and <span class="math inline">\(\frac{d\theta}{dt}(t=0) = 0\)</span>.</p>
<p>The exact solution for this ODE is known which is <span class="math inline">\(\theta = \theta_0 \cos\left( \sqrt{g}{l} t \right)\)</span>.</p>
<p>But if the assumptions of small angle oscillations and no damping are relaxed then the equation of motion becomes:
<span class="math display">\[\begin{equation}
\frac{d^2\theta}{dt^2}+C\frac{d\theta}{dt}+\frac{g}{l}\sin \theta = 0
\end{equation}\]</span>
with initial conditions remaining the same. But solving this ODE analytically is impossible. Therefore, we need access to numerical methods to solve ODEs.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li><strong>Partial Differential Equations(PDEs):-</strong></li>
</ol>
<p>Some examples are Wave Equation(Hyperbolic PDE)
<span class="math display">\[\partial{\partial^2 u}{\partial t^2}-c^2 \nabla^2 u= 0\]</span></p>
<p>Heat/Diffusion Equation(Parabolic PDE)
<span class="math display">\[\partial{\partial u}{\partial t}-\alpha \nabla^2 u= 0\]</span></p>
<p>Laplace Equation(Elliptic PDE)
<span class="math display">\[\nabla^2 u = 0 \text{ on } \Omega\]</span>
with boundary condition <span class="math inline">\(u = f(x,y,z)\)</span> on <span class="math inline">\(\partial \Omega\)</span></p>
<p>For specific boundaries like a rectangle, the solution can be found analytically. But for a general boundaries, it is extremely difficult to find analytical solutions. Therefore, numerical methods have to be used for solving these PDEs.</p></li>
</ol>
<p>In this course, we consider solving only ODEs i.e, 1 independent variable per dependent variable.</p>
</div>
<div id="finite-differences" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Finite Differences<a href="numerical-differentiation.html#finite-differences" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To construct approximations for derivatives, we use Taylor series. Let <span class="math inline">\(f(t)\)</span> be a real differentiable function whose values are known at <span class="math inline">\(\{t_i\}_{i=0}^n=t_0+i h\)</span> where <span class="math inline">\(h = \Delta t\)</span> which is a constant</p>
<p>Define <span class="math inline">\(f_i = f(t_i)\)</span> and <span class="math inline">\(f&#39;_i = \frac{df}{dt}(t_i)\)</span></p>
<p>We can write <span class="math inline">\(f_{j+1}\)</span> in terms of <span class="math inline">\(f_j\)</span> and derivatives of <span class="math inline">\(f\)</span> at <span class="math inline">\(t_j\)</span> by writing Taylor series of <span class="math inline">\(f(t_{j+1})\)</span> about <span class="math inline">\(t=t_j\)</span>.</p>
<p><span class="math display">\[f_{j+1} = f(t_j+h)= f(t_j)+hf&#39;(t_j)+\frac{h^2}{2!}f&#39;&#39;(t_j)+\dots\]</span>
<span class="math display">\[\dfrac{f_{j+1}-f_j}{h}-\frac{h}{2!}f&#39;&#39;(t_j)-\frac{h^2}{3!}f&#39;&#39;&#39;(t_j)-\dots = f&#39;(t_j) = f&#39;_j\]</span></p>
<p><span class="math display">\[\begin{equation}
f&#39;_j = \dfrac{f_{j+1}-f_j}{h} + \mathcal{O}(h)
\end{equation}\]</span>
The above approximation is called <strong>Forward Finite Difference Approximation</strong></p>
<p>Now consider the Taylor series of <span class="math inline">\(f(t_{j-1})\)</span> about <span class="math inline">\(t=t_j\)</span>.</p>
<p><span class="math display">\[f_{j-1} = f(t_j-h)= f(t_j)-hf&#39;(t_j)+\frac{h^2}{2!}f&#39;&#39;(t_j)+\dots\]</span>
<span class="math display">\[\dfrac{f_{j}-f_{j-1}}{h}+\frac{h}{2!}f&#39;&#39;(t_j)-\frac{h^2}{3!}f&#39;&#39;&#39;(t_j)+\dots = f&#39;(t_j) = f&#39;_j\]</span></p>
<p><span class="math display">\[\begin{equation}
f&#39;_j = \dfrac{f_{j}-f_{j-1}}{h} + \mathcal{O}(h)
\end{equation}\]</span>
The above approximation is called <strong>Backward Finite Difference Approximation</strong></p>
<p>We can clearly see that both Forward and Backward Finite differences are <strong>1st order accurate.</strong> Now the question to ask is “Can we improve the order of accuracy?”</p>
<p>Consider the Taylor Series Expansions of <span class="math inline">\(f_{j+1}\)</span> and <span class="math inline">\(f_{j-1}\)</span> about <span class="math inline">\(t_j\)</span>.
<span class="math display">\[\begin{align*}
f_{j+1} &amp;= f(t_j)+hf&#39;(t_j)+\frac{h^2}{2!}f&#39;&#39;(t_j)+\frac{h^3}{3!}f&#39;&#39;&#39;(t_j)+\frac{h^4}{4!}f^{(4)}(t_j)+\dots\\
f_{j-1} &amp;= f(t_j)-hf&#39;(t_j)+\frac{h^2}{2!}f&#39;&#39;(t_j)-\frac{h^3}{3!}f&#39;&#39;&#39;(t_j)+\frac{h^4}{4!}f^{(4)}(t_j)-\dots
\end{align*}\]</span>
Subtracting () from (), we get
<span class="math display">\[\implies f_{j+1}-f_{j-1} = 2hf&#39;_j+\frac{2h^3}{3!}f&#39;&#39;&#39;(t_j)+\frac{2h^5}{5!}f^{(5)}(t_j)+\dots\]</span>
<span class="math display">\[\implies f_{j+1}-f_{j-1}-\frac{2h^3}{3!}f&#39;&#39;&#39;(t_j)-\frac{2h^5}{5!}f^{(5)}(t_j)-\dots = 2hf&#39;_j\]</span></p>
<p><span class="math display">\[\begin{equation}
f&#39;_j = \frac{f_{j+1}-f_{j-1}}{2h} + \mathcal{O}(h^2)
\end{equation}\]</span>
We can see that the order of accuracy has been improved to 2. This approximation is called <strong>Central Finite Difference Approximation.</strong></p>
<p><strong>ATTACH CODE/ACCURACY PLOT</strong></p>
<p>To improve the order of accuracy, we need to consider more “grid points”. To understand this clearly, let us consider the example below.</p>
<p><strong>Example:</strong> Construct Finite difference scheme to find <span class="math inline">\(f&#39;_j\)</span> from <span class="math inline">\(f_j\)</span>, <span class="math inline">\(f_{j\pm 1}\)</span> and <span class="math inline">\(f_{j \pm 2}\)</span>.</p>
<p><strong>Solution:</strong></p>
<p>Let
<span class="math display">\[\begin{equation}
f&#39;_j = a f_{j+2}+b f_{j+1}+cf_{j}+d f_{j-1}+e f_{j-2}
\end{equation}\]</span>
where <span class="math inline">\(a,b,c,d,e\)</span> are to be found.</p>
<p>Write Taylor series of <span class="math inline">\(f_{j \pm 1}\)</span> and <span class="math inline">\(f_{j\pm 1}\)</span> about <span class="math inline">\(t_j\)</span> on RHS of the above equation(), we get:
<span class="math display">\[\begin{align*}
f&#39;_j  &amp;= a\left(f(t_j)+2hf&#39;(t_j)+\frac{(2h)^2}{2!}f&#39;&#39;(t_j)+\frac{(2h)^3}{3!}f&#39;&#39;&#39;(t_j)+\frac{(2h)^4}{4!}f^{(4)}(t_j)+\frac{(2h)^5}{5!}f^{(5)}(t_j)+\dots \right) \\
&amp;+ b \left( f(t_j)+hf&#39;(t_j)+\frac{h^2}{2!}f&#39;&#39;(t_j)+\frac{h^3}{3!}f&#39;&#39;&#39;(t_j)+\frac{h^4}{4!}f^{(4)}(t_j)+\frac{h^5}{5!}f^{(5)}(t_j)+\dots \right)\\
&amp;+ cf_j \\
&amp;+ d \left(f(t_j)-hf&#39;(t_j)+\frac{h^2}{2!}f&#39;&#39;(t_j)-\frac{h^3}{3!}f&#39;&#39;&#39;(t_j)+\frac{h^4}{4!}f^{(4)}(t_j)-\frac{h^5}{5!}f^{(5)}(t_j)+\dots \right)\\
&amp;+ e \left( f(t_j)-2hf&#39;(t_j)+\frac{(2h)^2}{2!}f&#39;&#39;(t_j)-\frac{(2h)^3}{3!}f&#39;&#39;&#39;(t_j)+\frac{(2h)^4}{4!}f^{(4)}(t_j)-\frac{(2h)^5}{5!}f^{(5)}(t_j)+\dots \right)
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
\implies f&#39;_j  &amp;= (a+b+c+d+e) f_j + h(2a+b-d-2e)f&#39;_j+ \frac{h^2}{2!}(4a+b+d+4e) f&#39;&#39;_j \\
&amp;+ \frac{h^3}{3!}(8a+b-d-8e) f&#39;&#39;&#39;_j + \frac{h^4}{4!}(16a+b+d+16e) f^{(4)}_j\\
&amp;+ \frac{h^5}{5!}(32a+b-d-32e) f^{(5)}_j+\mathcal{O}(h^6)
\end{align*}\]</span>
Now there are 5 variables but infinitely many equations(obtained after comparing coefficients of <span class="math inline">\(f\)</span> and its derivatives at <span class="math inline">\(t_j\)</span> on both sides of the above equation).
On comparing coefficients of <span class="math inline">\(f_j, f&#39;_j, \dots, f^{(4)}_j\)</span>, we get 5 equations in 5 variables and order of accuracy in Taylor series is 5. If we take any other set of 5 equations, we get order of accuracy in Taylor series lower than 5. Thus, to get the best order of accuracy, the following equations must be true.</p>
<p><span class="math display">\[\begin{align}
a+b+c+d+e &amp;=0\\
h(2a+b-d-2e) &amp;=1\\
4a+b+d+4e &amp;=0\\
8a+b-d-8e &amp;=0\\
16a+b+d+16e &amp;=0
\end{align}\]</span></p>
<p>On solving these set of equations, we get the values of <span class="math inline">\((a,b,c,d,e)\)</span> as:</p>
<p><span class="math display">\[\begin{equation}
(a,b,c,d,e) = \left(-\frac{1}{12h}, \frac{2}{3h}, 0 , -\frac{2}{3h}, \frac{1}{12h} \right)
\end{equation}\]</span></p>
<p>Therefore the finite difference approximation with 4th order accuracy is:
<span class="math display">\[\begin{equation}
f&#39;_j = \frac{1}{12h}(-f_{j+2}+8f_{j+1}-8f_{j-1}+f_{j-2}) + \mathcal{O}(h^4)
\end{equation}\]</span></p>
<!-- # Blocks -->
<!-- ## Equations -->
<!-- Here is an equation. -->
<!-- \begin{equation}  -->
<!--   f\left(k\right) = \binom{n}{k} p^k\left(1-p\right)^{n-k} -->
<!--   (\#eq:binom) -->
<!-- \end{equation}  -->
<!-- You may refer to using `\@ref(eq:binom)`, like see Equation \@ref(eq:binom). -->
<!-- ## Theorems and proofs -->
<!-- Labeled theorems can be referenced in text using `\@ref(thm:tri)`, for example, check out this smart theorem \@ref(thm:tri). -->
<!-- ::: {.theorem #tri} -->
<!-- For a right triangle, if $c$ denotes the *length* of the hypotenuse -->
<!-- and $a$ and $b$ denote the lengths of the **other** two sides, we have -->
<!-- $$a^2 + b^2 = c^2$$ -->
<!-- ::: -->
<!-- Read more here <https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html>. -->
<!-- ## Callout blocks -->
<!-- The R Markdown Cookbook provides more help on how to use custom blocks to design your own callouts: https://bookdown.org/yihui/rmarkdown-cookbook/custom-blocks.html -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="root-finding-algorithms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="solving-ordinary-differential-equations-numerically.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-Numerical_Differentiation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
