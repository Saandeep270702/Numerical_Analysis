<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Quadratures | Numerical Analysis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Quadratures | Numerical Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Quadratures | Numerical Analysis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Sai Saandeep.S, Dr. Sivaram" />


<meta name="date" content="2024-12-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="interpolation.html"/>
<link rel="next" href="root-finding-algorithms.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-numerical-analysis"><i class="fa fa-check"></i><b>1.1</b> Why Numerical Analysis?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#representing-numbers-on-a-machine"><i class="fa fa-check"></i><b>1.2</b> Representing Numbers on a Machine</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#condition-number-of-a-problem"><i class="fa fa-check"></i><b>1.3</b> Condition Number of a Problem</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#vector-normsrecap"><i class="fa fa-check"></i><b>1.3.1</b> Vector Norms(Recap)</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#examples-on-finding-condition-number"><i class="fa fa-check"></i><b>1.3.2</b> Examples on finding Condition number</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html"><i class="fa fa-check"></i><b>2</b> Numerical Linear Algebra</a>
<ul>
<li class="chapter" data-level="2.1" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#columnspace-nullspace-and-all"><i class="fa fa-check"></i><b>2.1</b> Columnspace, Nullspace and all</a></li>
<li class="chapter" data-level="2.2" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#matrix-norms"><i class="fa fa-check"></i><b>2.2</b> Matrix Norms</a></li>
<li class="chapter" data-level="2.3" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#condition-number-of-matrix-vector-products"><i class="fa fa-check"></i><b>2.3</b> Condition number of Matrix vector products</a></li>
<li class="chapter" data-level="2.4" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#solving-linear-systems"><i class="fa fa-check"></i><b>2.4</b> Solving Linear Systems</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#special-matrices"><i class="fa fa-check"></i><b>2.4.1</b> Special Matrices</a></li>
<li class="chapter" data-level="2.4.2" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#general-case"><i class="fa fa-check"></i><b>2.4.2</b> General Case</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#solving-overdetermined-systems"><i class="fa fa-check"></i><b>2.5</b> Solving Overdetermined Systems</a></li>
<li class="chapter" data-level="2.6" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#solving-underdetermined-systems"><i class="fa fa-check"></i><b>2.6</b> Solving Underdetermined Systems</a></li>
<li class="chapter" data-level="2.7" data-path="numerical-linear-algebra.html"><a href="numerical-linear-algebra.html#iterative-methods-for-solving-linear-systems"><i class="fa fa-check"></i><b>2.7</b> Iterative Methods for solving Linear Systems</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="interpolation.html"><a href="interpolation.html"><i class="fa fa-check"></i><b>3</b> Interpolation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="interpolation.html"><a href="interpolation.html#motivation---interpolation-vs.-approximation"><i class="fa fa-check"></i><b>3.1</b> Motivation - Interpolation vs. Approximation</a></li>
<li class="chapter" data-level="3.2" data-path="interpolation.html"><a href="interpolation.html#lagrange-interpolation"><i class="fa fa-check"></i><b>3.2</b> Lagrange Interpolation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="interpolation.html"><a href="interpolation.html#motivation"><i class="fa fa-check"></i><b>3.2.1</b> Motivation</a></li>
<li class="chapter" data-level="3.2.2" data-path="interpolation.html"><a href="interpolation.html#lagrange-interpolant"><i class="fa fa-check"></i><b>3.2.2</b> Lagrange Interpolant</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="interpolation.html"><a href="interpolation.html#choice-of-nodes"><i class="fa fa-check"></i><b>3.3</b> Choice of Nodes</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="interpolation.html"><a href="interpolation.html#motivation-1"><i class="fa fa-check"></i><b>3.3.1</b> Motivation</a></li>
<li class="chapter" data-level="3.3.2" data-path="interpolation.html"><a href="interpolation.html#fundamental-theorem-of-polynomial-interpolation"><i class="fa fa-check"></i><b>3.3.2</b> Fundamental Theorem of Polynomial Interpolation</a></li>
<li class="chapter" data-level="3.3.3" data-path="interpolation.html"><a href="interpolation.html#different-possible-types-of-nodes"><i class="fa fa-check"></i><b>3.3.3</b> Different Possible types of nodes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="interpolation.html"><a href="interpolation.html#wierstrass-approximation-theorem"><i class="fa fa-check"></i><b>3.4</b> Wierstrass Approximation theorem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadratures.html"><a href="quadratures.html"><i class="fa fa-check"></i><b>4</b> Quadratures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadratures.html"><a href="quadratures.html#motivation-2"><i class="fa fa-check"></i><b>4.1</b> Motivation</a></li>
<li class="chapter" data-level="4.2" data-path="quadratures.html"><a href="quadratures.html#different-schemes"><i class="fa fa-check"></i><b>4.2</b> Different Schemes</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="quadratures.html"><a href="quadratures.html#basic-schemes"><i class="fa fa-check"></i><b>4.2.1</b> Basic Schemes</a></li>
<li class="chapter" data-level="4.2.2" data-path="quadratures.html"><a href="quadratures.html#accuracy-of-these-schemes"><i class="fa fa-check"></i><b>4.2.2</b> Accuracy of these schemes</a></li>
<li class="chapter" data-level="4.2.3" data-path="quadratures.html"><a href="quadratures.html#simpsons-rule"><i class="fa fa-check"></i><b>4.2.3</b> Simpson’s Rule</a></li>
<li class="chapter" data-level="4.2.4" data-path="quadratures.html"><a href="quadratures.html#trapezoidal-rule-with-end-point-corrections"><i class="fa fa-check"></i><b>4.2.4</b> Trapezoidal Rule with End point Corrections</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="quadratures.html"><a href="quadratures.html#euler-maclaurian-formula"><i class="fa fa-check"></i><b>4.3</b> Euler-Maclaurian Formula</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="quadratures.html"><a href="quadratures.html#introduction-1"><i class="fa fa-check"></i><b>4.3.1</b> Introduction</a></li>
<li class="chapter" data-level="4.3.2" data-path="quadratures.html"><a href="quadratures.html#formula-and-derivation"><i class="fa fa-check"></i><b>4.3.2</b> Formula and Derivation</a></li>
<li class="chapter" data-level="4.3.3" data-path="quadratures.html"><a href="quadratures.html#examples"><i class="fa fa-check"></i><b>4.3.3</b> Examples</a></li>
<li class="chapter" data-level="4.3.4" data-path="quadratures.html"><a href="quadratures.html#higher-order-quadratures"><i class="fa fa-check"></i><b>4.3.4</b> Higher Order Quadratures</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="quadratures.html"><a href="quadratures.html#gaussian-quadratures"><i class="fa fa-check"></i><b>4.4</b> Gaussian Quadratures</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html"><i class="fa fa-check"></i><b>5</b> Root Finding Algorithms</a>
<ul>
<li class="chapter" data-level="5.1" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#motivation-3"><i class="fa fa-check"></i><b>5.1</b> Motivation</a></li>
<li class="chapter" data-level="5.2" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#bisection-method"><i class="fa fa-check"></i><b>5.2</b> Bisection Method</a></li>
<li class="chapter" data-level="5.3" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#newton-method"><i class="fa fa-check"></i><b>5.3</b> Newton Method</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#rate-of-convergence"><i class="fa fa-check"></i><b>5.3.1</b> Rate of Convergence</a></li>
<li class="chapter" data-level="5.3.2" data-path="root-finding-algorithms.html"><a href="root-finding-algorithms.html#possibility-of-non-convergence"><i class="fa fa-check"></i><b>5.3.2</b> Possibility of Non-Convergence?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html"><i class="fa fa-check"></i><b>6</b> Numerical Differentiation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html#motivation-4"><i class="fa fa-check"></i><b>6.1</b> Motivation</a></li>
<li class="chapter" data-level="6.2" data-path="numerical-differentiation.html"><a href="numerical-differentiation.html#finite-differences"><i class="fa fa-check"></i><b>6.2</b> Finite Differences</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html"><i class="fa fa-check"></i><b>7</b> Solving Ordinary Differential Equations Numerically</a>
<ul>
<li class="chapter" data-level="7.1" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#different-basic-methods"><i class="fa fa-check"></i><b>7.2</b> Different Basic Methods</a></li>
<li class="chapter" data-level="7.3" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#linear-stability-analysis"><i class="fa fa-check"></i><b>7.3</b> Linear Stability Analysis</a></li>
<li class="chapter" data-level="7.4" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#accuracy"><i class="fa fa-check"></i><b>7.4</b> Accuracy</a></li>
<li class="chapter" data-level="7.5" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#simple-pendulum---solving-system-of-odes"><i class="fa fa-check"></i><b>7.5</b> Simple Pendulum - Solving System of ODEs</a></li>
<li class="chapter" data-level="7.6" data-path="solving-ordinary-differential-equations-numerically.html"><a href="solving-ordinary-differential-equations-numerically.html#simple-pendulum---finite-difference-for-2nd-order-derivative"><i class="fa fa-check"></i><b>7.6</b> Simple Pendulum - Finite difference for 2nd order derivative</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Numerical Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="quadratures" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Quadratures<a href="quadratures.html#quadratures" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, we see how to find a definite integral numerically.</p>
<div id="motivation-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Motivation<a href="quadratures.html#motivation-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider a continuous function <span class="math inline">\(f(x)\)</span> in an interval <span class="math inline">\([a,b]\)</span>. We are interested in finding the integral <span class="math inline">\(\int_a^b f(x)\, dx\)</span>.</p>
<p>If we don’t know <span class="math inline">\(f(x)\)</span> at all points, then how to find integral? Based on what we have studied till now, one way we can think of to approximate the integral is to first find a polynomial interpolant <span class="math inline">\(p(x)\)</span> using the known points and then find the integral <span class="math inline">\(\int_a^b p(x) \, dx\)</span>. We can say that
<span class="math display">\[\begin{equation}
\int_a^b f(x)\, dx \approx \int_a^b p(x) \, dx
\end{equation}\]</span></p>
<p>But we have seen that there are issues like non-uniform convergence based in node distribution in the previous chapter. Therefore, we avoid this method. We resort to other methods to find the definite integral numerically.</p>
<p>Now, even if we know the exact form of the function at all points in the interval <span class="math inline">\((a,b)\)</span>, we can not always find a closed form for the anti-derivative of the function.</p>
<p><a href="Example:-" class="uri">Example:-</a> Consider <span class="math inline">\(f(x) = \exp(-x^2)\)</span>. We can’t find the exact form of <span class="math inline">\(\int f(x)\, dx = \int e^{-x^2}\, dx\)</span>. We can find <span class="math inline">\(\int_{-\infty}^{\infty} e^{-x^2}\, dx\)</span> using multivariable calculus methods say exactly. But for some random finite interval <span class="math inline">\((a,b)\)</span>, it is impossible to find the exact value. To get the approximate value, we use numerical methods.</p>
<p>In some cases, though finding exact value of the integral is possible, it is extremely difficult to find it.</p>
</div>
<div id="different-schemes" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Different Schemes<a href="quadratures.html#different-schemes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="basic-schemes" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Basic Schemes<a href="quadratures.html#basic-schemes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>ATTACH FIGURES FOR EACH SCHEME</strong></p>
<ol style="list-style-type: decimal">
<li>Lower/Left Riemann Sum:</li>
</ol>
<p><span class="math display">\[\begin{equation}
\int_a^b f(x) \, dx \approx \sum_{i=0}^{n-1} f(x_i) \left( \frac{b-a}{n} \right)
\end{equation}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Upper/Right Riemann Sum:</li>
</ol>
<p><span class="math display">\[\begin{equation}
\int_a^b f(x) \, dx \approx \sum_{i=1}^{n} f(x_i) \left( \frac{b-a}{n} \right)
\end{equation}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Trapezoidal Rule:
Instead of rectangles, let us approximate the areas by first dividing into trapeziums and summing up areas.</li>
</ol>
<p><span class="math display">\[\begin{equation}
\int_a^b f(x) \, dx \approx \frac{1}{2} h \left[ \sum_{i=1}^n (f(x_{i-1})+f(x_i)) \right]
\end{equation}\]</span></p>
<p>We can see that the trapezoidal rule is an average of Left and Right Riemann Sums.</p>
<ol start="4" style="list-style-type: decimal">
<li>Midpoint/Rectangular rule</li>
</ol>
<p><span class="math display">\[\begin{equation}
\int_a^b f(x) \, dx \approx h \sum_{i=0}^{n-1} f\left( \frac{x_i+x_{i+1}}{2} \right)
\end{equation}\]</span></p>
</div>
<div id="accuracy-of-these-schemes" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Accuracy of these schemes<a href="quadratures.html#accuracy-of-these-schemes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now the question arises - How accurate are these approximations? We’ll estimate how accurate are the integrals in each sub-interval <span class="math inline">\(\int_{x_i}^{x_{i+1}} f(x)\, dx\)</span>.</p>
<div id="midpoint-rule" class="section level4 hasAnchor" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> Midpoint Rule<a href="quadratures.html#midpoint-rule" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(h_i = |x_{i+1}-x_i|\)</span> and <span class="math inline">\(y_i = (x_i+x_{i+1})/2\)</span> for <span class="math inline">\(i\in \{0,\dots,n-1\}\)</span>.</p>
<p>The Taylor’s expansion of <span class="math inline">\(f(x)\)</span> about <span class="math inline">\(x = y_i\)</span> is:
<span class="math display">\[\begin{align*}
f(x) &amp;= f(y_i) + (x-y_i) f&#39;(y_i) + \frac{(x-y_i)^2}{2!} f&#39;&#39;(y_i) + \frac{(x-y_i)^3}{3!} f^{(3)}(y_i)+ \frac{(x-y_i)^4}{4!} f^{(4)}(y_i)\\
&amp;+ \frac{(x-y_i)^5}{5!} f^{(5)}(y_i)+ \frac{(x-y_i)^6}{6!} f^{(6)}(\zeta_i)
\end{align*}\]</span>
where <span class="math inline">\(\zeta_i \in [x_i,x_{i+1}]\)</span>. Now we integrate the above equation on both sides from <span class="math inline">\(x_{i}\)</span> to <span class="math inline">\(x_{i+1}\)</span>. Observe that,</p>
<p><span class="math display">\[\begin{align*}
\int_{x_i}^{x_{i+1}} (x-y_i)^{2k+1}\, dx &amp;= \int_{x_i-y_i}^{x_{i+1}-y_i}t^{2k+1}\, dt &amp; (t= x - y_i)\\
&amp;= \int_{-h_i/2}^{h_i/2}t^{2k+1}\, dt = 0  &amp;
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
\int_{x_i}^{x_{i+1}} (x-y_i)^{2k}\, dx &amp;= \int_{-h_i/2}^{h_i/2}t^{2k}\, dt &amp; (t= x - y_i)\\
&amp;= \dfrac{h_i^{2k+1}}{2^{2k}(2k+1)} &amp;
\end{align*}\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[\int_{x_i}^{x_{i+1}} f(x)\, dx = h_i f(y_i) + \frac{h_i^3}{24}f&#39;&#39;(y_i)+\frac{h_i^5}{1920}f^{(4)}(y_i)+ \mathcal{O}(h_i^6)\]</span>
and thus, error on a single panel caused by midpoint rule quadrature is given by:
<span class="math display">\[\begin{equation}
\label{eq: midpoint step integral}
\int_{x_i}^{x_{i+1}} f(x)\, dx - h_i f(y_i) =  \frac{h_i^3}{24}f&#39;&#39;(y_i)+\frac{h_i^5}{1920}f^{(4)}(y_i)+ \mathcal{O}(h_i^6)
\end{equation}\]</span>
In other words, for each integral over a sub-interval <span class="math inline">\([x_i,x_{i+1}]\)</span>, midpoint rule is <span class="math inline">\(\mathcal{O}(h_i^3)\)</span> accurate.</p>
<p>To estimate the error in evaluating <span class="math display">\[I = \int_a^b f(x) \, dx = \sum_{i = 0}^{n-1} \int_{x_i}^{x_{i+1}} f(x)\, dx,\]</span> we find the sum of errors in each of the <span class="math inline">\(n\)</span> integrals. Now, let’s make a simplifying assumption. Assume that the interval <span class="math inline">\([a,b]\)</span> is divided into <span class="math inline">\(n\)</span> equal sub-intervals of length <span class="math inline">\(h = (b-a)/n\)</span>. Thus,
<span class="math display">\[I = \sum_{i=0}^{n-1} \left[ h f(y_i) + \frac{h^3}{24} f&#39;&#39;(y_i) + \frac{h^5}{1920} f^{(4)}(y_i) + \mathcal{O}(h^6) \right]\]</span>
<span class="math display">\[\implies I = h\sum_{i=0}^{n-1} f(y_i)+ \frac{h^3}{24} \sum_{i=0}^{n-1}f&#39;&#39;(y_i) + \frac{h^5}{1920}\sum_{i=0}^{n-1}f^{(4)}(y_i) + \mathcal{O}(nh^6)\]</span>
<span class="math display">\[\implies \int_{a}^b f(x)\, dx - h\sum_{i=0}^{n-1} f(y_i) = \frac{h^3}{24} n f&#39;&#39;(z) + \mathcal{O}(nh^5)\]</span>
where <span class="math display">\[f&#39;&#39;(z) = \frac{\sum_{i=0}^{n-1}f&#39;&#39;(y_i)}{n}\]</span> and <span class="math inline">\(z\in[a,b]\)</span>. Note that existence of such a <span class="math inline">\(z\)</span> can be shown using the intermediate value theorem. Also, as <span class="math inline">\(nh = b-a\)</span>, we can say that</p>
<!-- $$\text{Error} = \int_{a}^b f(x)\, dx - h\sum_{i=0}^{n-1} f(y_i) = \frac{h^2}{24} (b-a) f''(z) + \mathcal{O}[(b-a)h^4]$$ -->
<p><span class="math display">\[\begin{equation}
\text{Error} = \int_{a}^b f(x)\, dx - h\sum_{i=0}^{n-1} f(y_i) = \frac{h^2}{24} (b-a) f&#39;&#39;(z) + \mathcal{O}[(b-a)h^4]
\end{equation}\]</span></p>
</div>
<div id="trapezoidal-rule" class="section level4 hasAnchor" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Trapezoidal Rule<a href="quadratures.html#trapezoidal-rule" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have from equation<span class="math inline">\(\ref{eq: midpoint step integral}\)</span></p>
<p><span class="math display">\[\int_{x_i}^{x_{i+1}} f(x)\, dx = h_i f(y_i) + \frac{h_i^3}{24}f&#39;&#39;(y_i)+\frac{h_i^5}{1920}f^{(4)}(y_i)+ \text{H.O.T},\]</span>
and the Taylor’s expansion of <span class="math inline">\(f(x)\)</span> about <span class="math inline">\(y_i\)</span>:
<span class="math display">\[f(x) = f(y_i) +(x-y_i)f(y_i) + \frac{(x-y_i)^2}{2!} f&#39;&#39;(y_i) + \frac{(x-y_i)^3}{3!} f^{(3)}(y_i)+ \frac{(x-y_i)^4}{4!} f^{(4)}(\xi_i).\]</span>
On substituting <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_{i+1}\)</span> in the above equation and using the fact that <span class="math inline">\(y_i-x_{i} = h_i/2 = x_{i+1}-y_i\)</span>, we obtain:
<span class="math display">\[\frac{f(x_i)+f(x_{i+1})}{2} = f(y_i)+\frac{h_i^2}{8}f&#39;&#39;(y_i)+ \mathcal{O}(h_i^4).\]</span>
Thus,
<span class="math display">\[\begin{align*}
\int_{x_i}^{x_{i+1}} f(x)\,dx- h_i \frac{f(x_i)+f(x_{i+1})}{2} &amp;= \left[h_if(y_i)+\frac{h_i^3}{24}f&#39;&#39;(y_i) +\mathcal{O}(h_i^5)\right] \\
&amp;- h_i\left[f(y_i)+\frac{h_i^2}{8}f&#39;&#39;(y_i) +\mathcal{O}(h_i^4)\right].
\end{align*}\]</span>
<!-- $$\int_{x_i}^{x_{i+1}} f(x)\,dx- h_i \frac{f(x_i)+f(x_{i+1})}{2} = \left[h_if(y_i)+\frac{h_i^3}{24}f''(y_i) +\mathcal{O}(h_i^5)\right] - h_i\left[f(y_i)+\frac{h_i^2}{8}f''(y_i) +\mathcal{O}(h_i^4)\right].$$ -->
<span class="math display">\[\implies \int_{x_i}^{x_{i+1}} f(x)\,dx- h_i \frac{f(x_i)+f(x_{i+1})}{2} = -\frac{h_i^3}{12}f&#39;&#39;(y_i)+\mathcal{O}(h_i^5)\]</span>
Following the same assumptions as stated for calculating error in midpoint rule quadrature <em>i.e.,</em> <span class="math inline">\(h_i = h = (b-a)/n\)</span>, we can find out the error in estimating the integral <span class="math inline">\(\int_a^b f(x)\, dx\)</span> to be:
<span class="math display">\[ \int_{a}^b f(x)\, dx - h\sum_{i=0}^{n-1}\frac{f(x_i)+f(x_{i+1})}{2} = -\frac{h^3}{12} n f&#39;&#39;(z) + \mathcal{O}(nh^5),\]</span>
where <span class="math display">\[f&#39;&#39;(z) = \frac{\sum_{i=0}^{n-1}f&#39;&#39;(y_i)}{n},\]</span> and <span class="math inline">\(z\in[a,b]\)</span> (from Intermediate Value Theorem). Thus,
<span class="math display">\[\begin{equation}
\text{Error} = \int_{a}^b f(x)\, dx - h\sum_{i=0}^{n-1} \frac{f(x_i)+f(x_{i+1})}{2} = -\frac{(b-a)h^2}{12}f&#39;&#39;(z) + \mathcal{O}[(b-a)h^4]
\end{equation}\]</span></p>
</div>
</div>
<div id="simpsons-rule" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Simpson’s Rule<a href="quadratures.html#simpsons-rule" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall that the errors in estimating the integral <span class="math inline">\(\int_a^b f(x)\, dx\)</span> using
<span class="math display">\[\begin{align}
\text{Midpoint rule} &amp;= \frac{(b-a)h^2}{24}f&#39;&#39;(z)+\mathcal{O}(h^4)\\
\text{Trapezoidal rule} &amp;= -\frac{(b-a)h^2}{12}f&#39;&#39;(z) + \mathcal{O}(h^4)
\end{align}\]</span></p>
<p>Thus, these quadratures are 2nd order accurate methods. Now, next question arises. Can we do better? The answer turns out to be yes. Let <span class="math inline">\(R(f)\)</span> and <span class="math inline">\(T(f)\)</span> be the estimates of the integral <span class="math inline">\(\int_a^b f(x)\, dx\)</span> using rectangular (midpoint) rule and Trapezoidal rule respectively <em>i.e.,</em></p>
<p><span class="math display">\[\begin{align}
R(f) &amp;= \sum_{i=0}^{n-1}hf(y_i)\\
T(f) &amp;= \sum_{i=0}^{n-1}\frac{h}{2}[f(x_i)+f(x_{i+1})]
\end{align}\]</span></p>
<p>Now, consider the approximation
<span class="math display">\[\int_a^b f(x)\, dx  \approx \frac{2R(f) + T(f)}{3}.\]</span>
The error caused by this approximation is:
<span class="math display">\[ \int_a^bf(x)\, dx - \frac{2R(f) + T(f)}{3} = \frac{1}{3} \left(\frac{2}{24}-\frac{1}{12} \right) (b-a)h^2f&#39;&#39;(z) + \mathcal{O}(h^4) = \mathcal{O}(h^4).\]</span></p>
<p>Therefore, the quadrature:
<span class="math display">\[\begin{equation}
\int_a^b f(x)\, dx  \approx \frac{2R(f) + T(f)}{3} = h\sum_{i=0}^{n-1}\frac{4f(y_i)+f(x_i)+f(x_{i+1})}{6},
\end{equation}\]</span>
is 4th order accurate. This is known as the <strong>Simpson’s rule</strong>.</p>
</div>
<div id="trapezoidal-rule-with-end-point-corrections" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Trapezoidal Rule with End point Corrections<a href="quadratures.html#trapezoidal-rule-with-end-point-corrections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s rewrite Simpson’s rule for quadrature as follows:
<span class="math display">\[\int_a^b f(x)\, dx  \approx \frac{2}{3}h \sum_{i=0}^{n-1}f(y_i)+\frac{h}{6}[f(x_0)+f(x_n)]+\frac{h}{3}\sum_{i=1}^{n-1}f(x_i)\]</span></p>
<p>Therefore, we can observe that Simpson’s rule requires <span class="math inline">\((2n+1)\)</span> function evaluations. Now, can we develop a scheme which is of the same order as that of the Simpson’s rule but has lesser function evaluations? To do this, let us revisit Trapezoidal rule.</p>
<p>The integral <span class="math inline">\(\int_{x_i}^{x_{i+1}}f(x)\, dx\)</span> is found out to be
<span class="math display">\[\int_{x_i}^{x_{i+1}} f(x)\,dx = h \frac{f(x_i)+f(x_{i+1})}{2}  -\frac{h^3}{12}f&#39;&#39;(y_i)+\mathcal{O}(h^5)\]</span>
To estimate <span class="math inline">\(f&#39;&#39;(y_i)\)</span>, we use Taylor series of <span class="math inline">\(f&#39;(x)\)</span> about <span class="math inline">\(y_i\)</span> for <span class="math inline">\(x=x_i\)</span> and <span class="math inline">\(x=x_{i+1}\)</span>.</p>
<!-- $$f'(x_i) = f'(y_i) + (x_i-y_i)f''(y_i)+ \frac{(x_i-y_i)^2}{2!}f'''(y_i) + \frac{(x_i-y_i)^3}{3!}f^{(4)}(y_i) + \frac{(x_i-y_i)^4}{4!}f^{(5)}(y_i)+ \text{H.O.T}$$ -->
<!-- $$f'(x_{i+1}) = f'(y_i) + (x_{i+1}-y_i)f''(y_i)+ \frac{(x_{i+1}-y_i)^2}{2!}f'''(y_i) + \frac{(x_{i+1}-y_i)^3}{3!}f^{(4)}(y_i) + \frac{(x_{i+1}-y_i)^4}{4!}f^{(5)}(y_i)+ \text{H.O.T}$$ -->
<p><span class="math display">\[\begin{align*}
f&#39;(x_i) &amp;= f&#39;(y_i) + (x_i-y_i)f&#39;&#39;(y_i)+ \frac{(x_i-y_i)^2}{2!}f&#39;&#39;&#39;(y_i) \\
        &amp;+\frac{(x_i-y_i)^3}{3!}f^{(4)}(y_i) + \frac{(x_i-y_i)^4}{4!}f^{(5)}(y_i)+ \text{H.O.T}\\
f&#39;(x_{i+1}) &amp;= f&#39;(y_i) + (x_{i+1}-y_i)f&#39;&#39;(y_i)+ \frac{(x_{i+1}-y_i)^2}{2!}f&#39;&#39;&#39;(y_i) \\
            &amp;+\frac{(x_{i+1}-y_i)^3}{3!}f^{(4)}(y_i) + \frac{(x_{i+1}-y_i)^4}{4!}f^{(5)}(y_i) + \text{H.O.T}        
\end{align*}\]</span></p>
<p>Using the fact that <span class="math inline">\(y_i - x_i = h/2 = x_{i+1}-y_i\)</span>, we can see that:
<span class="math display">\[f&#39;(x_{i+1})-f&#39;(x_i) = hf&#39;&#39;(y_i) + \frac{h^3}{24}f^{(4)}(y_i)+\text{H.O.T}\]</span>
<span class="math display">\[\implies f&#39;&#39;(y_i) = \frac{f&#39;(x_{i+1})-f&#39;(x_i)}{h}-\frac{h^2}{24}f^{(4)}(y_i)+ \text{H.O.T}\]</span>
Thus, on subtituting the value of <span class="math inline">\(f&#39;&#39;(y_i)\)</span> in the panel integral, we get:
<span class="math display">\[\int_{x_i}^{x_{i+1}} f(x)\, dx = h \frac{f(x_i)+f(x_{i+1})}{2}  -\frac{h^2}{12}[f&#39;(x_{i+1})-f&#39;(x_i)]+\mathcal{O}(h^5).\]</span>
We now find <span class="math inline">\(\int_a^b f(x)\, dx\)</span> by summing the panel integrals <span class="math inline">\(\int_{x_i}^{x_{i+1}}f(x)\, dx\)</span> from <span class="math inline">\(i=0\)</span> to <span class="math inline">\(i=n-1\)</span> and using the information that <span class="math inline">\(x_0 = a\)</span>, <span class="math inline">\(x_n = b\)</span> and <span class="math inline">\(nh = b-a\)</span>, we can find out that the integral to be:</p>
<p><span class="math display">\[\begin{equation}
\int_a^b f(x)\, dx = \frac{h}{2}\sum_{i=0}^{n-1}[f(x_i)+f(x_{i+1})] - \frac{h^2}{12}[f&#39;(b)-f&#39;(a)]+\mathcal{O}(h^4).
\end{equation}\]</span></p>
<p>This quadrature is referred to as <strong>Modified Trapezoidal rule</strong> or <strong>Trapezoidal rule with end point corrections</strong>. We can observe that</p>
<ol style="list-style-type: decimal">
<li><p>This quadrature requires <span class="math inline">\(n+3\)</span> function evaluations (More precisely, <span class="math inline">\(n+1\)</span> function evaluations &amp; 2 derivative evaluations) which is lesser compared to that of Simpson’s rule. Thus, we have achieved a quadrature having same order of accuracy but requiring smaller computational cost.</p></li>
<li><p>To estimate integral using this method, we need to have access to the derivative of the function only at the end points but not any intermediate points between <span class="math inline">\(x=a\)</span> and <span class="math inline">\(x=b\)</span>.</p></li>
</ol>
<p>Similarly one can write a <strong>Rectangular (Mid point) rule with end point corrections</strong> as:
<span class="math display">\[\begin{equation}
\int_a^b f(x)\, dx = h\sum_{i=0}^{n-1}f\left(\frac{x_i+x_{i+1}}{2}\right) + \frac{h^2}{24}[f&#39;(b)-f&#39;(a)]+\mathcal{O}(h^4).
\end{equation}\]</span></p>
</div>
</div>
<div id="euler-maclaurian-formula" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Euler-Maclaurian Formula<a href="quadratures.html#euler-maclaurian-formula" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, if we have access to higher derivatives at the end points then can we get more accurate quadratures? We shall answer this question in this section.</p>
<div id="introduction-1" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Introduction<a href="quadratures.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="formula-and-derivation" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Formula and Derivation<a href="quadratures.html#formula-and-derivation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Euler-Maclaurin summation is as follows:</p>
<p>Let <span class="math inline">\(p\in \mathbb{N}\)</span>. If <span class="math inline">\(f \in C^{2p}([a, b])\)</span>, we then have,
<span class="math display">\[\begin{equation}
\sum_{n=a}^b f(n) = \int_a^bf(x)\, dx+\frac{f(a)+f(b)}{2}+\sum_{k=1}^p \frac{b_{2k}}{(2k)!}[f^{(2k-1)}(b) - f^{(2k-1)}(a)]-\int_a^b \frac{B_{2p}(\{t\})}{(2p)!}f^{(2p)}(t) \, dt
\end{equation}\]</span>
where <span class="math inline">\(B_k(x)\)</span> are the Bernoulli polynomials of degree <span class="math inline">\(k\)</span>, <span class="math inline">\(b_k = B_k(0)\)</span> are the Bernoulli numbers and <span class="math inline">\(\{t\}\in[0,1)\)</span> is fractional part of t.</p>
<p><strong>Bernoulli Polynomial:</strong> The Bernoulli polynomials <span class="math inline">\(\{B_k(x)\}_{k\geq 0}\)</span> are defined as:
<span class="math display">\[\begin{align}
B_0(x) &amp;= 1\\
B_k&#39;(x) &amp;= kB_{k-1}(x)\\
\int_0^1 B_k(x)\, dx &amp;= 1 \ \ \ \forall k\geq 1
\end{align}\]</span>
First few Bernoulli polynomials are: <span class="math display">\[\{ 1, x-\frac{1}{2}, x^2-x+\frac{1}{6}, x^3-\frac{3}{2}x^2+\frac{1}{2}x, \dots \},\]</span>
and hence corresponding Bernoulli numbers are <span class="math display">\[\{1,-\frac{1}{2},\frac{1}{6},0,\dots\}.\]</span></p>
<p><strong>Proof of Euler-Maclaurian formula</strong></p>
<p>We shall prove this by induction.</p>
<p><em>Base Case</em> (<span class="math inline">\(p=1\)</span>)</p>
<p>We need to show that: <span class="math display">\[ \sum_{n=a}^b f(n) = \int_a^b f(x)\, dx + \frac{f(a)+f(b)}{2}+ \frac{b_2}{2!}[f&#39;(b)-f&#39;(a)]-\int_a^b \frac{B_2(\{t\})}{2!}f&#39;&#39;(t)\, dt,\]</span> or in other words <span class="math display">\[ \int_a^b \frac{B_2(\{t\})}{2!}f&#39;&#39;(t)\, dt =  \int_a^b f(x)\, dx + \frac{f(a)+f(b)}{2}+ \frac{b_2}{2!}[f&#39;(b)-f&#39;(a)]-\sum_{n=a}^b f(n) .\]</span></p>
<p>We first split the integral into sum of integral over panels.
<span class="math display">\[\int_a^b \frac{B_2(\{t\})}{2!}f&#39;&#39;(t)\, dt = \frac{1}{2} \sum_{n=a}^{b-1}\int_{n}^{n+1}B_2(\{t\})\,d(f&#39;(t)).\]</span> Now let us consider each panel integral.
<span class="math display">\[\int_{n}^{n+1}B_2(\{t\})d(f&#39;(t)) = \int_{n}^{n+1} \left(\{t\}^2-\{t\}+\frac{1}{6} \right)\, d(f&#39;(t))\]</span>
<span class="math display">\[ =\int_{n}^{n+1} \left[(t-n)^2-(t-n)+\frac{1}{6} \right]\, d(f&#39;(t)) \]</span>
<span class="math display">\[ = \left[f&#39;(t)\left((t-n)^2-(t-n)+\frac{1}{6}\right) \right]_{n}^{n+1}-\int_{n}^{n+1}(2(t-n)-1)f&#39;(t)\, dt\]</span>
<span class="math display">\[ = \frac{1}{6}[f&#39;(n+1)-f&#39;(n)] - \int_n^{n+1}f&#39;(t) (2t-2n-1)\, dt\]</span></p>
<p><span class="math display">\[\int_n^{n+1}f&#39;(t) (2t-2n-1)\, dt = \left[(2t-2n-1) f(t) \right]_n^{n+1}-\int_n^{n+1}2f(t)\, dt\]</span>
<span class="math display">\[=f(n+1)+f(n)-2\int_n^{n+1}f(t)\, dt\]</span></p>
<p><span class="math display">\[\implies \int_{n}^{n+1}B_2(\{t\})d(f&#39;(t)) =\frac{1}{6}[f&#39;(n+1)-f&#39;(n)] -f(n+1)-f(n)+2\int_n^{n+1}f(t)\, dt\]</span>
<span class="math display">\[\implies \sum_{n=a}^{b-1}\int_{n}^{n+1}B_2(\{t\})d(f&#39;(t)) = \frac{1}{6}[f&#39;(b)-f&#39;(a)] -\sum_{n=a}^{b-1}[f(n+1)+f(n)]+2\int_a^{b}f(t)\, dt \]</span></p>
<p><span class="math display">\[\implies \int_a^b B_2(\{t\})f&#39;&#39;(t)\, dt = \frac{1}{6}[f&#39;(b)-f&#39;(a)] -2\sum_{n=a}^b f(n) + f(a) + f(b)+2\int_a^b f(t)\, dt\]</span>
<span class="math display">\[\implies \int_a^b \frac{B_2(\{t\})}{2!}f&#39;&#39;(t)\, dt = \frac{1}{12}[f&#39;(b)-f&#39;(a)] -\sum_{n=a}^b f(n) +\frac{f(a)+f(b)}{2}+\int_a^b f(t)\, dt.\]</span>
Since <span class="math inline">\(b_2 = 1/6\)</span>, we can rewrite the above expression as:
<span class="math display">\[\frac{B_2(\{t\})}{2!}f&#39;&#39;(t)\, dt = \int_a^b f(t)\, dt+\frac{f(a)+f(b)}{2}+\frac{b_2}{2}[f&#39;(b)-f&#39;(a)]  -\sum_{n=a}^b f(n).\]</span></p>
<p><em>Inductive step</em> (Assume that the formula is true for some <span class="math inline">\(p\)</span>, then the formula is true for <span class="math inline">\(p+1\)</span>)</p>
<p>We assume that for some <span class="math inline">\(p \ge 1\)</span>, the Euler-Maclaurian summation is true.</p>
<p><span class="math display">\[\sum_{n=a}^b f(n) = \int_a^bf(x)\, dx+\frac{f(a)+f(b)}{2}+\sum_{k=1}^p \frac{b_{2k}}{(2k)!}(f^{(2k-1)}(b) - f^{(2k-1)}(a))-\int_a^b \frac{B_{2p}(\{t\})}{(2p)!}f^{(2p)}(t) \, dt\]</span></p>
<p>Now, we need to now prove that the above is true for <span class="math inline">\(p+1\)</span>, i.e., we need to prove that</p>
<p><span class="math display">\[
\sum_{n=a}^{b} f(n)=\int_{a}^{b} f(x) d x+\frac{f(b)+f(a)}{2}+\sum_{k=1}^{p+1} \frac{b_{2 k}}{(2 k) !}\left(f^{(2 k-1)}(b)-f^{(2 k-1)}(a)\right)-\int_{a}^{b} \frac{B_{2(p+1)}(\{t\})}{(2(p+1)) !} f^{(2(p+1))}(t) \, dt
\]</span></p>
<p>Subtracting the above 2 equations, we can say that the inductive step is equivalent to proving:</p>
<p><span class="math display">\[\begin{equation}\label{eq: 1a final}
    \int_{a}^{b} \frac{B_{2(p+1)}(\{t\})}{(2(p+1)) !} f^{(2(p+1))}(t) d t=\int_{a}^{b} \frac{B_{2 p}(\{t\})}{(2 p) !} f^{(2 p)}(t) d t+\frac{b_{2(p+1)}}{(2(p+1)) !}\left(f^{(2 p+1)}(b)-f^{(2 p+1)}(a)\right)
\end{equation}\]</span></p>
<p>Define LHS of equation<span class="math inline">\(\eqref{eq: 1a final}\)</span> as:
<span class="math display">\[I_{p+1} = \int_{a}^{b} \frac{B_{2(p+1)}(\{t\})}{(2(p+1)) !} f^{(2(p+1))}(t)\,  dt\]</span>
<span class="math display">\[\implies I_{p+1} = \sum_{n=a}^{b-1} \int_{n}^{n+1} \frac{B_{2(p+1)}(\{t\})}{(2(p+1)) !} f^{(2(p+1))}(t) \, dt = \sum_{n=a}^{b-1} \int_{n}^{n+1} \frac{B_{2(p+1)}(t-n)}{(2(p+1)) !} f^{(2(p+1))}(t)\,  dt \]</span>
Define <span class="math display">\[J_{n,p+1} = \int_{n}^{n+1} \frac{B_{2(p+1)}(t-n)}{(2(p+1)) !} f^{(2(p+1))}(t)\,  dt\]</span></p>
<p>Integrating by-parts, we get:
<span class="math display">\[
\begin{aligned}
J_{n, p+1} &amp; =\left[B_{2(p+1)}(t-n) f^{(2 p+1)}(t)\right]_{n} ^{n+1}-\int_{n}^{n+1} B&#39;_{2(p+1)}(t-n) f^{(2 p+1)}(t) d t \\
\implies J_{n, p+1} &amp; =B_{2(p+1)}(1) f^{(2 p+1)}(n+1)-B_{2(p+1)}(0) f^{(2 p+1)}(n)-\int_{n}^{n+1} 2(p+1) B_{2 p+1}(t-n) f^{(2 p+1)}(t) d t \\
\implies J_{n, p+1} &amp; =b_{2(p+1)}\left(f^{(2 p+1)}(n+1)-f^{(2 p+1)}(n)\right)-2(p+1) \int_{n}^{n+1} B_{2 p+1}(t-n) f^{(2 p+1)}(t) d t \\
\implies J_{n, p+1} &amp; =b_{2(p+1)}\left(f^{(2 p+1)}(n+1)-f^{(2 p+1)}(n)\right)\\&amp;-2(p+1)\left(\left[B_{2 p+1}(t-n) f^{(2p)}(t)\right]_{n} ^{n+1}-\int_{n}^{n+1} B&#39;_{2 p+1}(t-n) f^{(2p)}(t) d t\right).
\end{aligned}
\]</span></p>
<p>As <span class="math inline">\(B_k(0) = B_k(1)\)</span> for <span class="math inline">\(k\ge 2\)</span>, we have used <span class="math inline">\(B_{2(p+1)}(1) = B_{2(p+1)}(0)\)</span> for <span class="math inline">\(p\ge 1\)</span>.</p>
<p>Therefore,
<span class="math display">\[
\begin{aligned}
J_{n, p+1} &amp; =b_{2(p+1)}\left(f^{(2 p+1)}(n+1)-f^{(2 p+1)}(n)\right)+2(p+1)\left(\int_{n}^{n+1} B&#39;_{2 p+1}(t-n) f^{(2 m)}(t) d t\right) \\
\implies J_{n, p+1}&amp; =b_{2(p+1)}\left(f^{(2 p+1)}(n+1)-f^{(2 p+1)}(n)\right)+2(p+1)\left(\int_{n}^{n+1}(2 p+1) B_{2 p}(t-n) f^{(2 p)}(t) d t\right) \\
\implies J_{n, p+1} &amp; =b_{2(p+1)}\left(f^{(2 p+1)}(n+1)-f^{(2 p+1)}(n)\right)+2(p+1)(2 p+1) I_{n, p-1}
\end{aligned}
\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[
\begin{aligned}
I_{p+1} &amp; =\sum_{n=a}^{b-1} J_{n, p+1}=\sum_{n=a}^{b-1}\left(b_{2(p+1)}\left(f^{(2 p+1)}(n+1)-f^{(2 p+1)}(n)\right)+2(p+1)(2 p+1) J_{n, p-1}\right) \\
\implies I_{p+1} &amp; =b_{2(p+1)} \sum_{n=a}^{b-1}\left(f^{(2 p+1)}(n+1)-f^{(2 p+1)}(n)\right)+(2 p+2)(2 p+1) \sum_{n=a}^{b-1} J_{n, p-1} \\
\implies I_{p+1} &amp; =b_{2(p+1)}\left(f^{(2 p+1)}(b)-f^{(2 p+1)}(a)\right)+(2 p+2)(2 p+1) I_{p} \\
\implies \frac{I_{p+1}}{(2(p+1)) !} &amp; =\frac{b_{2(p+1)}}{(2(p+1)) !}\left(f^{(2 p+1)}(b)-f^{(2 p+1)}(a)\right)+\frac{I_{p}}{(2 p) !}
\end{aligned}
\]</span></p>
<p><span class="math display">\[\implies \int_{a}^{b} \frac{B_{2(p+1)}(\{t\})}{(2(p+1)) !} f^{(2(p+1))}(t) d t =\int_{a}^{b} \frac{B_{2 p}(\{t\})}{(2 p) !} f^{(2 p)}(t) d t+\frac{b_{2(p+1)}}{(2(p+1)) !}\left(f^{(2 p+1)}(b)-f^{(2 p+1)}(a)\right)\]</span>
which proves the inductive step for any <span class="math inline">\(p\ge 1\)</span></p>
<p>As the base case <span class="math inline">\(p=1\)</span> and inductive step are true, we can say that the given statement
is true according to principle of mathematical induction.</p>
</div>
<div id="examples" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Examples<a href="quadratures.html#examples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider <span class="math inline">\(f(x) = 1/x\)</span> and <span class="math inline">\(a=1\)</span> and <span class="math inline">\(b = m \in \{2,3\dots\}\)</span>. We substitute these in Euler-Maclaurian formula for <span class="math inline">\(p=1\)</span> to obtain the below expression:
<span class="math display">\[\sum_{n=1}^m \frac{1}{n} = \ln m+\frac{1}{2}+\frac{1}{2m}+\frac{b_2}{2}\left( 1-\frac{1}{m^2}\right)-\int_1^m \frac{B_2(\{t\})}{t^3}\, dt.\]</span>
The LHS is the <span class="math inline">\(m^{\text{th}}\)</span> Harmonic sum <span class="math inline">\(H_m\)</span>. We’ll now substitute the values of <span class="math inline">\(b_2 = 1/6\)</span> and <span class="math inline">\(B_2(\{t\}) = \{t\}^2-\{t\}+1/6\)</span> to estimate <span class="math inline">\(H_m\)</span>.</p>
<p><span class="math display">\[H_m = \ln m + \frac{7}{12}+\frac{1}{2m}-\frac{1}{12m^2}-\int_1^m \frac{B_2(\{t\})}{t^3}\, dt.\]</span>
<span class="math display">\[\int_1^m \frac{B_2(\{t\})}{t^3}\, dt = \int_1^{\infty} \frac{B_2(\{t\})}{t^3}\, dt -\int_m^{\infty} \frac{B_2(\{t\})}{t^3}\, dt\]</span>
As <span class="math inline">\(\{t\}\in [0,1)\)</span>, we can observe that <span class="math inline">\(0\leq |B(\{t\})| \leq 1/6\)</span>, and hence
<span class="math display">\[0 \leq \Bigg|\int_m^{\infty} \frac{B_2(\{t\})}{t^3}\, dt\Bigg| \leq \Bigg|\int_m^{\infty} \frac{1}{6t^3}\, dt\Bigg|=\frac{1}{12m^2}.\]</span>
This implies:
<span class="math display">\[\Bigg| H_m -\ln m- \gamma -\frac{1}{12m} \Bigg| = \Bigg| \frac{1}{12m^2} + \int_m^{\infty} \frac{B_2(\{t\})}{t^3}\, dt \Bigg| \leq \frac{1}{6m^2},\]</span>
where <span class="math display">\[\gamma := \frac{7}{12} - \int_1^{\infty} \frac{B_2(\{t\})}{t^3}\,dt,\]</span> is the Euler-Mascheroni constant. Not many properties of this constant is known yet (<em>Eg:</em> Is <span class="math inline">\(\gamma\)</span> rational or irrational? Algebraic or transcendental?). Keeping aside these burning questions, we can thus say that:
<span class="math display">\[\begin{equation}
H_m \approx \ln m+ \gamma +\frac{1}{12m} \ \ \text{; \ Error} = \frac{1}{6m^2}
\end{equation}\]</span>
As an example, <span class="math inline">\(H_{10^6} = \ln 10^6 + \gamma +1/(2\times 10^6)\)</span> with an error of <span class="math inline">\(1/(6\times 10^{12})\)</span>.</p>
<p>We can also derive Stirling’s approximation using Euler-Maclaurian formula by taking
<span class="math inline">\(f(n) = \ln n\)</span> to get <span class="math display">\[\log(n!) = \log\left( \sqrt{2\pi n} \left(\frac{n}{e} \right)^n\right)+ \mathcal{O}\left( \frac{1}{n}\right)\]</span></p>
</div>
<div id="higher-order-quadratures" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Higher Order Quadratures<a href="quadratures.html#higher-order-quadratures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have seen what Euler-Maclaurian formula is, now we’ll come back to our question posed earlier in this section. Can we get more accurate quadratures if we know higher derivatives at the end-points. We can firstly see that:
<span class="math display">\[\int_a^b f(x) \, dx = \sum_{k=0}^{n-1}\int_{x_k}^{x_{k+1}} f(x)\, dx\]</span>
Each panel integral can be written as:
<span class="math display">\[\int_{x_k}^{x_{k+1}} f(x)\, dx = \int_0^1 f(x_0+kh+\alpha h) h\, d\alpha = h \int_0^1 F(\alpha) \, d\alpha\]</span>
where <span class="math inline">\(x = x_k + \alpha h = x_0+kh+\alpha h\)</span> and as <span class="math inline">\(x \in [x_k,x_{k+1}]\)</span>, we have <span class="math inline">\(\alpha \in [0,1]\)</span> and <span class="math inline">\(F(\alpha) = f(x_0+kh+\alpha h)\)</span>. Now, we use Euler-Maclaurian formula to evaluate <span class="math inline">\(\int_0^1F(\alpha)\, d\alpha\)</span>.</p>
<p><span class="math display">\[\int_0^1F(\alpha)\, d\alpha = \sum_{n=0}^1 F(n) - \frac{F(0)+F(1)}{2}-\sum_{k=1}^p \frac{b_{2k}}{(2k)!}[F^{(2k-1)}(1)-F^{(2k-1)}(0)]+\int_0^1 \frac{B_{2p}(\{t\})}{(2p)!}F^{(2p)}\,dt\]</span>
<span class="math display">\[\implies \int_0^1F(\alpha)\, d\alpha =  \frac{F(0)+F(1)}{2}-\sum_{k=1}^p \frac{b_{2k}}{(2k)!}[F^{(2k-1)}(1)-F^{(2k-1)}(0)]+\int_0^1 \frac{B_{2p}(\{t\})}{(2p)!}F^{(2p)}(t)\,dt.\]</span>
Let us now revert back from <span class="math inline">\(F(\alpha)\)</span> to <span class="math inline">\(f(x)\)</span>. Note that as <span class="math inline">\(F(\alpha) = f(x_0+kh+\alpha h)\)</span>, we have <span class="math inline">\(F^{(m)}(\alpha) = h^m f^{(m)}(x_0+kh+\alpha h)\)</span> for any <span class="math inline">\(m\geq 1\)</span>. Thus,</p>
<p><span class="math display">\[\int_{0}^1 F(\alpha)\, d\alpha = \frac{f(x_k)+f(x_{k+1})}{2}-\sum_{l=1}^p \frac{b_{2l}}{(2l)!}h^{2l-1}[f^{(2l-1)}(x_{k+1})-f^{(2l-1)}(x_k)]+h^{2p} \tilde{R}_p,\]</span>
where <span class="math display">\[\tilde{R}_p := \int_0^1 \frac{B_{2p}(\{t\})}{(2p)!}f^{(2p)}(x_0+kh+th)\,dt.\]</span> Thus, integral over a panel would be <span class="math display">\[\int_{x_{k}}^{x_{k+1}}f(x)\, dx = \alpha \int_0^1 F(\alpha)\, d\alpha\]</span>
<span class="math display">\[\int_{x_k}^{x_{k+1}}f(x)\, dx = \frac{h}{2}[f(x_k)+f(x_{k+1})]-\sum_{l=1}^p \frac{b_{2l}}{(2l)!}h^{2l}[f^{(2l-1)}(x_{k+1})-f^{(2l-1)}(x_k)]+h^{2p+1} \tilde{R}_p.\]</span>
We sum up these panel integrals to get <span class="math inline">\(\int_a^b f(x)\, dx\)</span> as follows:
<span class="math display">\[\int_a^b f(x)\, dx = \sum_{k=0}^{n-1}\int_{x_k}^{x_{k+1}} f(x)\, dx\]</span>
<span class="math display">\[\implies \int_a^b f(x)\, dx = \frac{h}{2}[f(x_0)+f(x_n)]+h\sum_{k=1}^{n-1}f(x_k) - \sum_{l=1}^p\frac{b_{2l}}{(2l)!}h^{2l}[f^{2l-1}(b)-f^{(2l-1)}(a)]+\mathcal{O}(h^{2p})\]</span>
Substituting an appropriate value of <span class="math inline">\(p\)</span> gives a quadrature which is <span class="math inline">\(\mathcal{O}(h^{2p})\)</span> accurate. For example:</p>
<ol style="list-style-type: decimal">
<li><p>On substituting <span class="math inline">\(p=1\)</span>, <span class="math inline">\(p=2\)</span>, we get back trapezoidal rule and modified trapezoial rules respectively.</p></li>
<li><p>For <span class="math inline">\(p=3\)</span>, we get a <span class="math inline">\(\mathcal{O}(h^6)\)</span> Trapezoidal rule as follows:
<span class="math display">\[ \int_a^b f(x)\, dx = \frac{h}{2}[f(a)+f(b)] + h\sum_{i=1}^{n-1}f(x_i) -\frac{h^2}{12}[f&#39;(b)-f&#39;(a)]+\frac{h^4}{720}[f&#39;&#39;&#39;(b)-f&#39;&#39;&#39;(a)]+\mathcal{O}(h^6).\]</span></p></li>
</ol>
</div>
</div>
<div id="gaussian-quadratures" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Gaussian Quadratures<a href="quadratures.html#gaussian-quadratures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- # Parts -->
<!-- You can add parts to organize one or more book chapters together. Parts can be inserted at the top of an .Rmd file, before the first-level chapter heading in that same file.  -->
<!-- Add a numbered part: `# (PART) Act one {-}` (followed by `# A chapter`) -->
<!-- Add an unnumbered part: `# (PART\*) Act one {-}` (followed by `# A chapter`) -->
<!-- Add an appendix as a special kind of un-numbered part: `# (APPENDIX) Other stuff {-}` (followed by `# A chapter`). Chapters in an appendix are prepended with letters instead of numbers. -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="interpolation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="root-finding-algorithms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-Quadratures.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
